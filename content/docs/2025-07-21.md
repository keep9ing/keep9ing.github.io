---
title: "asp 뭔데"
date: "2025-07-30"
draft: false
---

### 🧱 기본 구조

- ASP 코드는 `<%` 와 `%>` 사이에 작성돼요.

    ```csharp
    <% Response.Write "Hello ASP!" %>
    ```

### 📌 변수 선언

- `Dim` 키워드로 변수 선언
    ```csharp
    Dim userName
    userName = "JIHYE"
    ```

### 🔁 조건문

- `If...Then...Else`
    ```csharp
    <% 
      Dim age
      age = 25
      If age >= 20 Then
        Response.Write "성인입니다."
      Else
        Response.Write "미성년자입니다."
      End If
    %>
    ```

- `Select Case` (조건이 많을 때)
    ```csharp
    <% 
      Dim grade
      grade = "A"
      Select Case grade
        Case "A"
          Response.Write "우수"
        Case "B"
          Response.Write "양호"
        Case Else
          Response.Write "재시험"
      End Select
    %>
    ```

### 🔄 반복문
- `For...Next
    ```csharp
    <% 
      Dim i
      For i = 1 To 5
        Response.Write i & "<br>"
      Next
    %>
    ```

- `Do While...Loop`
    ```csharp
    <% 
      Dim i
      i = 1
      Do While i <= 5
        Response.Write i & "<br>"
        i = i + 1
      Loop
    %>
    ```


### 🧮 내장 함수 예시

|함수|설명|예시|
|---|---|---|
|`Now()`|현재 날짜/시간 반환|`Response.Write Now()`|
|`UCase()`|문자열을 대문자로 변환|`UCase("jihye") → "JIHYE"`|
|`Len()`|문자열 길이 반환|`Len("ASP") → 3`|
|`Replace()`|문자열 치환|`Replace("Hi Jihye", "Hi", "Hello")`|

## 📝 1. 폼 처리 (Form Handling)

사용자 입력을 받아 처리하는 기본 방식이에요.

### 📌 HTML 폼 예시

html

```html
<form method="post" action="process.asp">
  이름: <input type="text" name="username"><br>
  <input type="submit" value="전송">
</form>
```

### 📌 ASP 처리 코드 (`process.asp`)

asp

```csharp
<%
Dim userName
userName = Request.Form("username")
Response.Write "입력한 이름은: " & userName
%>
```

- `Request.Form("username")`: POST 방식으로 전달된 값
- `Request.QueryString("username")`: GET 방식으로 전달된 값

## 🔐 2. 세션 사용 (Session Handling)

사용자 정보를 페이지 간에 유지할 때 사용돼요.

### 📌 세션 저장

```csharp
<%
Session("userID") = "jihye123"
%>
```

### 📌 세션 불러오기

```csharp
<%
Response.Write "로그인한 사용자: " & Session("userID")
%>
```

### 📌 세션 삭제

```csharp
<%
Session.Contents.Remove("userID") ' 특정 세션 삭제
Session.Abandon() ' 전체 세션 종료
%>
```

- 세션은 브라우저를 닫거나 일정 시간이 지나면 자동 종료돼요.
- 기본 타임아웃은 20분이며 `Session.Timeout = 30`으로 변경 가능


## 🗄️ 3. 데이터베이스 연결 (DB Connection)

ASP에서 DB와 연결해 데이터를 조회하거나 저장할 수 있어요.

### 📌 연결 및 조회 예시

```csharp
<%
Dim conn, rs, sql
Set conn = Server.CreateObject("ADODB.Connection")
conn.Open "Provider=SQLOLEDB;Data Source=서버주소;Initial Catalog=DB이름;User ID=아이디;Password=비번"

sql = "SELECT * FROM Users"
Set rs = conn.Execute(sql)

Do While Not rs.EOF
  Response.Write rs("Name") & "<br>"
  rs.MoveNext
Loop

rs.Close
Set rs = Nothing
conn.Close
Set conn = Nothing
%>
```

- `ADODB.Connection`: DB 연결 객체
- `ADODB.Recordset`: 결과를 담는 객체
- SQL Injection 방지를 위해 파라미터 처리에 주의해야 해요

🛡️ **SQL Injection**은 웹 애플리케이션의 보안 취약점을 악용해 **데이터베이스를 조작하거나 탈취하는 해킹 기법**이에요. 주로 사용자의 입력값을 제대로 검증하지 않을 때 발생하죠.

### 💣 SQL Injection이란?

- 공격자가 **악의적인 SQL 구문을 입력 필드에 삽입**해, 원래 의도된 쿼리를 변경시켜버리는 방식이에요.
- 예를 들어 로그인 폼에 `admin' OR '1'='1` 같은 값을 넣으면, 조건이 항상 참이 되어 **인증 없이 로그인**할 수 있게 되죠.
### 🔐 방어 방법

- **PreparedStatement / Parameterized Query 사용** → 쿼리와 데이터를 분리해서 SQL 구문 삽입을 막아요.
- **입력값 검증** → 화이트리스트 기반으로 허용된 값만 통과시키기
- **ORM 사용** → JPA, Hibernate 같은 프레임워크는 내부적으로 안전한 쿼리 생성
- **에러 메시지 숨기기** → DB 구조가 노출되지 않도록 에러를 사용자에게 보여주지 않기
